import{d as U,e as N,u as P,f as d,B as V,g as W,i,j as t,k as c,a as j,x as q,n as L,t as a,F as f,l as I,D as _,I as F,m as A,o as n,s as E}from"./vendor-1Pylr8mE.js";import{j as G,s as k,l as H,_ as O}from"./index-B3c5FRRi.js";import{m as C}from"./art-detail-info-QH3f716g.js";const Z={class:"detail-container"},J={class:"detail-layout"},K={class:"detail-info"},Q={class:"masterpiece-title"},X={class:"masterpiece-meta"},Y={class:"artist"},ee={class:"period"},te={key:0,class:"collection"},se={class:"detail-section"},le={class:"detail-section"},oe={class:"detail-section"},ie={class:"technique-tags"},ae={key:0,class:"detail-section"},ne={key:1,class:"detail-section"},re={class:"artwork-display"},ce={key:0,class:"image-container"},de=["src","alt"],ue={key:1,class:"placeholder-image"},pe={class:"placeholder-text"},ve={key:0,class:"detail-section"},me={class:"related-works"},ge=["onClick"],fe={key:0,class:"recommendations-section"},_e={class:"recommendations-grid"},ke=["onClick"],he={class:"recommendation-image-container"},be=["src","alt"],ye={key:1,class:"recommendation-placeholder"},we={class:"recommendation-info"},Ie=["src"],Ce=U({__name:"MasterpieceDetail",setup(Me){const M=P(),u=A(),p=N(()=>M.params.id),o=d(null),v=d([]),m=d(!1),h=d(null),b=d(!1),T=d(""),g={"0001":0,"0002":1,"0003":2,"0004":3,"0005":4,"0006":5,"0007":6,"0008":7,"0009":8,"0010":9,"0011":10,"0012":11,"0013":12,"0014":13,"0015":14},y=s=>{if(!s)return"";const e=s.split("/").pop();if(!e)return"";const l={"梅花山茶雪雀图.webp":0,"梨花斑鸠图.webp":1,"猿马图.webp":2,"芙蓉锦鸡图.webp":3,"桃鸠图.webp":4,"五色鹦鹉图.webp":5,"八花图卷.webp":6,"花鸟图卷.webp":7,"桃竹锦鸡图轴.webp":8,"狮头鹅图.webp":9,"桂菊山禽图.webp":10,"竹鹤图轴.webp":11,"秋海棠图.webp":12,"九兰图.webp":13,"兰竹图.webp":14,"八花图.webp":6,"桃竹锦鸡图.webp":8,"白牡丹图.webp":7,"竹鹤图.webp":11,"牧马图.webp":2};if(e in l)return k[l[e]];if(e.includes("paintings")){const r=e.match(/(\d{4})\.jpg/);if(r&&r[1]in g)return k[g[r[1]]]}for(const r of H)if(e.includes(r.title)){const w=r.id;if(w in g)return k[g[w]]}return e.includes("牧马图")?k[2]:(console.warn(`未找到图片: ${e}`),"")},$=()=>{h.value&&(h.value.scrollTop=0),window.scrollTo({top:0,behavior:"instant"});const s=document.querySelector(".masterpiece-detail-page");s&&(s.scrollTop=0)},B=async()=>{$(),m.value=!0,o.value=null,v.value=[],await E();const s=C.find(e=>e.id===p.value);if(s)o.value=s,v.value=C.filter(e=>e.id!==p.value&&(e.dynasty===s.dynasty||e.artist===s.artist)).slice(0,4);else{console.error(`未找到ID为${p.value}的作品详情`),u.push("/historical-timeline");return}setTimeout(()=>{m.value=!1,$()},300)};V(()=>M.params.id,(s,e)=>{s!==e&&(console.log(`作品ID已变更: ${e} -> ${s}`),B())},{immediate:!0});const R=s=>{if(s===p.value){console.log("已经在当前作品页面，不需要导航");return}u.replace(`/masterpiece/${s}`)},S=(s,e)=>{const l=C.find(r=>r.title===s&&r.artist===e);if(l){if(l.id===p.value){console.log("已经在当前作品页面，不需要导航");return}u.replace(`/masterpiece/${l.id}`)}else alert(`《${s}》的详细信息暂未添加，敬请期待！`)},x=()=>{m.value=!1;const s=sessionStorage.getItem("masterpieceReferrer");s?(sessionStorage.removeItem("masterpieceReferrer"),u.push(s)):u.push("/historical-timeline")},z=s=>{T.value=s,b.value=!0,document.body.style.overflow="hidden"},D=()=>{b.value=!1,document.body.style.overflow="auto"};return W(()=>{}),(s,e)=>(n(),i(f,null,[t("div",{class:"masterpiece-detail-page",ref_key:"detailPageRef",ref:h},[j(q(G),{activePath:"/historical-timeline",onBackClick:x}),e[14]||(e[14]=t("div",{class:"app-header-spacer"},null,-1)),o.value?(n(),i("div",{key:0,class:L(["content-container",{"content-transitioning":m.value}])},[t("button",{class:"back-button",onClick:x},"← 返回"),t("div",Z,[t("div",J,[t("div",K,[t("h1",Q,a(o.value.title),1),t("div",X,[t("span",Y,"作者: "+a(o.value.artist),1),t("span",ee,"年代: "+a(o.value.period)+" ("+a(o.value.dynasty)+"朝)",1),o.value.collection?(n(),i("span",te,"收藏: "+a(o.value.collection),1)):c("",!0)]),t("section",se,[e[2]||(e[2]=t("h2",null,"作品介绍",-1)),t("p",null,a(o.value.description),1)]),t("section",le,[e[3]||(e[3]=t("h2",null,"艺术价值",-1)),t("p",null,a(o.value.significance),1)]),t("section",oe,[e[4]||(e[4]=t("h2",null,"创作技法",-1)),t("div",ie,[(n(!0),i(f,null,I(o.value.technique,(l,r)=>(n(),i("span",{class:"tag",key:r},a(l),1))),128))])]),o.value.size?(n(),i("section",ae,[e[5]||(e[5]=t("h2",null,"作品规格",-1)),t("p",null,a(o.value.size),1)])):c("",!0),o.value.collection?(n(),i("section",ne,[e[6]||(e[6]=t("h2",null,"收藏地点",-1)),t("p",null,a(o.value.collection),1)])):c("",!0),e[7]||(e[7]=t("div",{class:"scroll-viewer-container"},[t("span",{class:"bug-notice"},"此跳转功能有BUG，待修复"),t("button",{class:"scroll-viewer-button",disabled:""},[t("span",{class:"scroll-icon"},"🖼️"),_(" 卷轴查看模式 ")])],-1))]),t("div",re,[o.value.imageUrl?(n(),i("div",ce,[t("img",{src:y(o.value.imageUrl),alt:o.value.title,class:"artwork-image",onClick:e[0]||(e[0]=l=>z(y(o.value.imageUrl)))},null,8,de)])):(n(),i("div",ue,[t("div",pe,[_(" 《"+a(o.value.title)+"》 ",1),e[8]||(e[8]=t("div",{class:"placeholder-subtext"},"图片准备中",-1))])]))])]),o.value.relatedWorks&&o.value.relatedWorks.length>0?(n(),i("section",ve,[e[12]||(e[12]=t("h2",null,"相关作品",-1)),t("div",me,[(n(!0),i(f,null,I(o.value.relatedWorks,(l,r)=>(n(),i("div",{key:r,class:"related-work-item",onClick:w=>S(l.title,l.artist)},[t("h3",null,a(l.title),1),t("p",null,[e[9]||(e[9]=t("strong",null,"作者:",-1)),_(" "+a(l.artist),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"关系:",-1)),_(" "+a(l.relation),1)]),e[11]||(e[11]=t("div",{class:"view-detail"},"查看详情 →",-1))],8,ge))),128))])])):c("",!0)]),v.value.length>0?(n(),i("section",fe,[e[13]||(e[13]=t("h2",{class:"section-title"},"相关画作推荐",-1)),t("div",_e,[(n(!0),i(f,null,I(v.value,l=>(n(),i("div",{key:l.id,class:"recommendation-card",onClick:r=>R(l.id)},[t("div",he,[l.imageUrl?(n(),i("img",{key:0,src:y(l.imageUrl),alt:l.title,class:"recommendation-image"},null,8,be)):(n(),i("div",ye,[t("span",null,a(l.title),1)]))]),t("div",we,[t("h3",null,a(l.title),1),t("p",null,a(l.artist)+" | "+a(l.dynasty)+"朝",1)])],8,ke))),128))])])):c("",!0)],2)):c("",!0)],512),b.value?(n(),i("div",{key:0,class:"image-modal",onClick:D},[t("div",{class:"image-modal-content",onClick:e[1]||(e[1]=F(()=>{},["stop"]))},[t("span",{class:"close-button",onClick:D},"×"),t("img",{src:T.value,alt:"Zoomed Image",class:"zoomed-image"},null,8,Ie)])])):c("",!0)],64))}}),De=O(Ce,[["__scopeId","data-v-327090d2"]]);export{De as default};
