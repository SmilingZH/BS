import{d as U,k as P,u as V,r as d,C as W,g as L,c as a,b as s,a as c,e as E,m as F,n as j,t as n,F as _,f as I,E as y,K as A,q as G,o as r,y as H}from"./vendor-B5ERtXls.js";import{k as K,s as b,o as T,_ as O}from"./index-4XJbkE_t.js";import{m}from"./art-detail-info-CC9r1Tz1.js";const Z={class:"detail-container"},J={class:"detail-layout"},Q={class:"detail-info"},X={class:"masterpiece-title"},Y={class:"masterpiece-meta"},ee={class:"artist"},te={class:"period"},se={key:0,class:"collection"},ie={class:"detail-section"},le={class:"detail-section"},oe={class:"detail-section"},ae={class:"technique-tags"},ne={key:0,class:"detail-section"},re={key:1,class:"detail-section"},ce={class:"artwork-display"},de={key:0,class:"image-container"},ue=["src","alt"],pe={key:1,class:"placeholder-image"},me={class:"placeholder-text"},ve={key:0,class:"detail-section"},fe={class:"related-works"},ge=["onClick"],_e={key:0,class:"recommendations-section"},ye={class:"recommendations-grid"},be=["onClick"],we={class:"recommendation-image-container"},he=["src","alt"],ke={key:1,class:"recommendation-placeholder"},Ie={class:"recommendation-info"},Te=["src"],Ce=U({__name:"MasterpieceDetail",setup(Me){const C=V(),u=G(),v=P(()=>C.params.id),l=d(null),p=d([]),f=d(!1),w=d(null),h=d(!1),M=d(""),g={"0001":0,"0002":1,"0003":2,"0004":3,"0005":4,"0006":5,"0007":6,"0008":7,"0009":8,"0010":9,"0011":10,"0012":11,"0013":12,"0014":13,"0015":14,"0016":15,"0017":16,"0018":17,"0019":18,"0020":19,"0021":20,"0022":21,"0023":22,"0024":23,"0025":24,"0026":25,"0027":26,"0028":27,"0029":28,"0030":29,"0031":30},D={"梅花山茶雪雀图.webp":0,"梨花斑鸠图.webp":1,"猿马图.webp":2,"芙蓉锦鸡图.webp":3,"桃鸠图.webp":4,"五色鹦鹉图.webp":5,"八花图卷.webp":6,"花鸟图卷.webp":7,"桃竹锦鸡图轴.webp":8,"狮头鹅图.webp":9,"桂菊山禽图.webp":10,"竹鹤图轴.webp":11,"秋海棠图.webp":12,"九兰图.webp":13,"兰竹图.webp":14,"江帆楼阁图.webp":15,"明皇幸蜀图.webp":16,"雪景寒林图.webp":17,"层叠冰绡图轴.webp":18,"溪山行旅图.webp":19,"山居图.webp":20,"墨梅图.webp":21,"枯木竹石图.webp":22,"墨竹坡石图轴.webp":23,"梅花小鸟.webp":24,"梅石图轴.webp":25,"驴背吟诗图轴.webp":26,"水墨牡丹图轴.webp":27,"疏树归林图.webp":28,"玉堂富贵图.webp":29,"月夜山鸡图.webp":30},k=i=>{if(!i)return"";const t=i.split("/").pop();if(!t)return"";if(t in D)return b[D[t]];if(t.includes("paintings")){const e=t.match(/(\d{4})\.jpg/);if(e&&e[1]in g)return b[g[e[1]]]}for(const e of T)if(t.includes(e.title)){const o=e.id;if(o in g)return b[g[o]]}return t.includes("牧马图")?b[2]:(console.warn(`未找到图片: ${t}`),"")},$=()=>{w.value&&(w.value.scrollTop=0),window.scrollTo({top:0,behavior:"instant"});const i=document.querySelector(".masterpiece-detail-page");i&&(i.scrollTop=0)},R=async()=>{$(),f.value=!0,l.value=null,p.value=[],await H();const i=v.value;console.log("尝试获取作品详情，ID:",i);let t=m.find(e=>e.id===i);if(!t&&i.match(/^0+/)){const e=i.replace(/^0+/,"");console.log("尝试使用无前导零ID匹配:",e),t=m.find(o=>o.id===e)}if(t)console.log("找到作品详情:",t.title),l.value=t,p.value=m.filter(e=>e.id!==v.value&&(e.dynasty===t.dynasty||e.artist===t.artist)).slice(0,4);else{console.error(`未找到ID为${i}的作品详情，尝试从image-info获取`);let e=T.find(o=>o.id===i);if(!e&&i.match(/^0+/)){const o=i.replace(/^0+/,"");e=T.find(q=>q.id===o)}if(e)console.log("从image-info中找到基本信息:",e),l.value={id:e.id,title:e.title,artist:e.artist,period:e.period,dynasty:e.dynasty,description:e.content,significance:e.yiyi||"暂无艺术价值和历史意义的介绍",technique:e.technique?[e.technique]:["暂无技法信息"],size:e.dimensions,collection:e.location},p.value=m.filter(o=>o.dynasty===e.dynasty||o.artist===e.artist).slice(0,4);else{setTimeout(()=>{alert("抱歉，未找到该作品的详细信息，即将返回历史长河页面"),u.push("/historical-timeline")},3e3);return}}setTimeout(()=>{f.value=!1,$()},300)};W(()=>C.params.id,(i,t)=>{i!==t&&(console.log(`作品ID已变更: ${t} -> ${i}`),R())},{immediate:!0});const S=i=>{if(i===v.value){console.log("已经在当前作品页面，不需要导航");return}u.replace(`/masterpiece/${i}`)},z=(i,t)=>{const e=m.find(o=>o.title===i&&o.artist===t);if(e){if(e.id===v.value){console.log("已经在当前作品页面，不需要导航");return}u.replace(`/masterpiece/${e.id}`)}else alert(`《${i}》的详细信息暂未添加，敬请期待！`)},B=()=>{f.value=!1;const i=sessionStorage.getItem("masterpieceReferrer");i?(sessionStorage.removeItem("masterpieceReferrer"),u.push(i)):u.push("/historical-timeline")},N=i=>{M.value=i,h.value=!0,document.body.style.overflow="hidden"},x=()=>{h.value=!1,document.body.style.overflow="auto"};return L(()=>{}),(i,t)=>(r(),a(_,null,[s("div",{class:"masterpiece-detail-page",ref_key:"detailPageRef",ref:w},[E(F(K),{activePath:"/historical-timeline",onBackClick:B}),t[14]||(t[14]=s("div",{class:"app-header-spacer"},null,-1)),l.value?(r(),a("div",{key:0,class:j(["content-container",{"content-transitioning":f.value}])},[s("div",Z,[s("div",J,[s("div",Q,[s("h1",X,n(l.value.title),1),s("div",Y,[s("span",ee,"作者: "+n(l.value.artist),1),s("span",te,"年代: "+n(l.value.period)+" ("+n(l.value.dynasty)+"朝)",1),l.value.collection?(r(),a("span",se,"收藏: "+n(l.value.collection),1)):c("",!0)]),s("section",ie,[t[2]||(t[2]=s("h2",null,"作品介绍",-1)),s("p",null,n(l.value.description),1)]),s("section",le,[t[3]||(t[3]=s("h2",null,"艺术价值",-1)),s("p",null,n(l.value.significance),1)]),s("section",oe,[t[4]||(t[4]=s("h2",null,"创作技法",-1)),s("div",ae,[(r(!0),a(_,null,I(l.value.technique,(e,o)=>(r(),a("span",{class:"tag",key:o},n(e),1))),128))])]),l.value.size?(r(),a("section",ne,[t[5]||(t[5]=s("h2",null,"作品规格",-1)),s("p",null,n(l.value.size),1)])):c("",!0),l.value.collection?(r(),a("section",re,[t[6]||(t[6]=s("h2",null,"收藏地点",-1)),s("p",null,n(l.value.collection),1)])):c("",!0),t[7]||(t[7]=s("div",{class:"scroll-viewer-container"},[s("span",{class:"bug-notice"},"此跳转功能有BUG，待修复"),s("button",{class:"scroll-viewer-button",disabled:""},[s("span",{class:"scroll-icon"},"🖼️"),y(" 卷轴查看模式 ")])],-1))]),s("div",ce,[l.value.imageUrl?(r(),a("div",de,[s("img",{src:k(l.value.imageUrl),alt:l.value.title,class:"artwork-image",onClick:t[0]||(t[0]=e=>N(k(l.value.imageUrl)))},null,8,ue)])):(r(),a("div",pe,[s("div",me,[y(" 《"+n(l.value.title)+"》 ",1),t[8]||(t[8]=s("div",{class:"placeholder-subtext"},"图片准备中",-1))])]))])]),l.value.relatedWorks&&l.value.relatedWorks.length>0?(r(),a("section",ve,[t[12]||(t[12]=s("h2",null,"相关作品",-1)),s("div",fe,[(r(!0),a(_,null,I(l.value.relatedWorks,(e,o)=>(r(),a("div",{key:o,class:"related-work-item",onClick:q=>z(e.title,e.artist)},[s("h3",null,n(e.title),1),s("p",null,[t[9]||(t[9]=s("strong",null,"作者:",-1)),y(" "+n(e.artist),1)]),s("p",null,[t[10]||(t[10]=s("strong",null,"关系:",-1)),y(" "+n(e.relation),1)]),t[11]||(t[11]=s("div",{class:"view-detail"},"查看详情 →",-1))],8,ge))),128))])])):c("",!0)]),p.value.length>0?(r(),a("section",_e,[t[13]||(t[13]=s("h2",{class:"section-title"},"相关画作推荐",-1)),s("div",ye,[(r(!0),a(_,null,I(p.value,e=>(r(),a("div",{key:e.id,class:"recommendation-card",onClick:o=>S(e.id)},[s("div",we,[e.imageUrl?(r(),a("img",{key:0,src:k(e.imageUrl),alt:e.title,class:"recommendation-image"},null,8,he)):(r(),a("div",ke,[s("span",null,n(e.title),1)]))]),s("div",Ie,[s("h3",null,n(e.title),1),s("p",null,n(e.artist)+" | "+n(e.dynasty)+"朝",1)])],8,be))),128))])])):c("",!0)],2)):c("",!0)],512),h.value?(r(),a("div",{key:0,class:"image-modal",onClick:x},[s("div",{class:"image-modal-content",onClick:t[1]||(t[1]=A(()=>{},["stop"]))},[s("span",{class:"close-button",onClick:x},"×"),s("img",{src:M.value,alt:"Zoomed Image",class:"zoomed-image"},null,8,Te)])])):c("",!0)],64))}}),qe=O(Ce,[["__scopeId","data-v-60a0efad"]]);export{qe as default};
